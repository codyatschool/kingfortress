/* @license
 * Copyright (c) 2016, Jeff Hlywa (jhlywa@gmail.com)
 * Modified by Cody Mims
 * Released under the BSD license
 * https://github.com/jhlywa/chess.js/blob/master/LICENSE
 */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(d){var h=0;return function(){return h<d.length?{done:!1,value:d[h++]}:{done:!0}}};$jscomp.arrayIterator=function(d){return{next:$jscomp.arrayIteratorImpl(d)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,h,k){d!=Array.prototype&&d!=Object.prototype&&(d[h]=k.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(d,h){this.$jscomp$symbol$id_=d;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:h})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function d(k){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(k||"")+"_"+h++,k)}var h=0;return d}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.asyncIterator;d||(d=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};
$jscomp.iteratorFromArray=function(d,h){$jscomp.initSymbolIterator();d instanceof String&&(d+="");var k=0,p={next:function(){if(k<d.length){var r=k++;return{value:h(r,d[r]),done:!1}}p.next=function(){return{done:!0,value:void 0}};return p.next()}};p[Symbol.iterator]=function(){return p};return p};
$jscomp.polyfill=function(d,h,k,p){if(h){k=$jscomp.global;d=d.split(".");for(p=0;p<d.length-1;p++){var r=d[p];r in k||(k[r]={});k=k[r]}d=d[d.length-1];p=k[d];h=h(p);h!=p&&null!=h&&$jscomp.defineProperty(k,d,{configurable:!0,writable:!0,value:h})}};$jscomp.polyfill("Array.prototype.keys",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d){return d})}},"es6","es3");
$jscomp.findInternal=function(d,h,k){d instanceof String&&(d=String(d));for(var p=d.length,r=0;r<p;r++){var y=d[r];if(h.call(k,y,r,d))return{i:r,v:y}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,k){return $jscomp.findInternal(this,d,k).v}},"es6","es3");
var Chess=function(d){function h(a){return Object.keys(l).find(function(b){return l[b]===a})}function k(){e=Array(128);t={w:-1,b:-1};q="w";n={w:0,b:0};A=-1;z=0;C=1;D=[];v={};M(y())}function p(a){var b=a.split(/\s+/),c=b[0],f=0;if(!r(a).valid)return!1;k();for(a=0;a<c.length;a++){var m=c.charAt(a);if("/"===m)f+=8;else if(-1!=="0123456789".indexOf(m))f+=parseInt(m,10);else{var e="a">m?"w":"b";N({type:m.toLowerCase(),color:e},x(f));f++}}q=b[1];-1<b[2].indexOf("K")&&(n.w|=g.KSIDE_CASTLE);-1<b[2].indexOf("Q")&&
(n.w|=g.QSIDE_CASTLE);-1<b[2].indexOf("k")&&(n.b|=g.KSIDE_CASTLE);-1<b[2].indexOf("q")&&(n.b|=g.QSIDE_CASTLE);A="-"===b[3]?-1:l[b[3]];z=parseInt(b[4],10);C=parseInt(b[5],10);M(y());return!0}function r(a){var b={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) is invalid.",5:"3rd field (castling availability) is invalid.",6:"2nd field (side to move) is invalid.",
7:"1st field (piece positions) does not contain 8 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"Illegal en-passant square"};a=a.split(/\s+/);if(6!==a.length)return{valid:!1,error_number:1,error:b[1]};if(isNaN(a[5])||0>=parseInt(a[5],10))return{valid:!1,error_number:2,error:b[2]};if(isNaN(a[4])||0>parseInt(a[4],10))return{valid:!1,error_number:3,
error:b[3]};if(!/^(-|[abcdefgh][36])$/.test(a[3]))return{valid:!1,error_number:4,error:b[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(a[2]))return{valid:!1,error_number:5,error:b[5]};if(!/^(w|b)$/.test(a[1]))return{valid:!1,error_number:6,error:b[6]};var c=a[0].split("/");if(8!==c.length)return{valid:!1,error_number:7,error:b[7]};for(var f=0;f<c.length;f++){for(var m=0,e=!1,d=0;d<c[f].length;d++)if(isNaN(c[f][d])){if(!/^[prnbqkPRNBQK]$/.test(c[f][d]))return{valid:!1,error_number:9,error:b[9]};m+=1;e=
!1}else{if(e)return{valid:!1,error_number:8,error:b[8]};m+=parseInt(c[f][d],10);e=!0}if(8!==m)return{valid:!1,error_number:10,error:b[10]}}return"3"==a[3][1]&&"w"==a[1]||"6"==a[3][1]&&"b"==a[1]?{valid:!1,error_number:11,error:b[11]}:{valid:!0,error_number:0,error:b[0]}}function y(){for(var a=0,b="",c=l.a8;c<=l.h1;c++){if(null==e[c])a++;else{0<a&&(b+=a,a=0);var f=e[c].type;b+="w"===e[c].color?f.toUpperCase():f.toLowerCase()}c+1&136&&(0<a&&(b+=a),c!==l.h1&&(b+="/"),a=0,c+=8)}a="";n.w&g.KSIDE_CASTLE&&
(a+="K");n.w&g.QSIDE_CASTLE&&(a+="Q");n.b&g.KSIDE_CASTLE&&(a+="k");n.b&g.QSIDE_CASTLE&&(a+="q");a=a||"-";c=-1===A?"-":x(A);return[b,q,a,c,z,C].join(" ")}function P(a){for(var b=0;b<a.length;b+=2)"string"===typeof a[b]&&"string"===typeof a[b+1]&&(v[a[b]]=a[b+1]);return v}function M(a){0<D.length||("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"!==a?(v.SetUp="1",v.FEN=a):(delete v.SetUp,delete v.FEN))}function Y(a){return(a=e[l[a]])?{type:a.type,color:a.color}:null}function N(a,b){if(!("type"in
a&&"color"in a&&-1!=="pnbrqkwPNBRQKW".indexOf(a.type.toLowerCase())&&b in l))return!1;b=l[b];if("k"==a.type&&-1!=t[a.color]&&t[a.color]!=b)return!1;e[b]={type:a.type,color:a.color};"k"===a.type&&(t[a.color]=b);M(y());return!0}function Q(a){var b=Y(a);e[l[a]]=null;b&&"k"===b.type&&(t[b.color]=-1);M(y());return b}function Z(a,b,c,f,m){b={color:q,from:b,to:c,flags:f,piece:a[b].type};m&&(b.flags|=g.PROMOTION,b.promotion=m);a[c]?b.captured=a[c].type:f&g.EP_CAPTURE&&(b.captured="p");return b}function F(a){function b(a,
b,c,f,m){if("p"!==a[c].type||0!==f>>4&&7!==f>>4)b.push(Z(a,c,f,m));else for(var d=["q","r","b","n"],e=0,ha=d.length;e<ha;e++)b.push(Z(a,c,f,m,d[e]))}var c=[],f=q,m=J(f),d=l.a8,w=l.h1,B=!1,p="undefined"!==typeof a&&"legal"in a?a.legal:!0;if("undefined"!==typeof a&&"square"in a)if(a.square in l)d=w=l[a.square],B=!0;else return[];for(a=d;a<=w;a++)if(a&136)a+=7;else{var h=e[a];if(null!=h&&h.color===f)if("p"===h.type){var u=a+R[f][0];null==e[u]&&(b(e,c,a,u,g.NORMAL),u=a+R[f][1],null==e[u]&&b(e,c,a,u,g.BIG_PAWN));
for(k=2;4>k;k++)u=a+R[f][k],u&136||(null!=e[u]&&e[u].color===m?b(e,c,a,u,g.CAPTURE):u===A&&b(e,c,a,A,g.EP_CAPTURE))}else{var k=0;for(d=aa[h.type].length;k<d;k++){var r=aa[h.type][k];for(u=a;;){u+=r;if(u&136)break;if(null==e[u])b(e,c,a,u,g.NORMAL);else{if(e[u].color===f)break;b(e,c,a,u,g.CAPTURE);break}if("n"===h.type||"k"===h.type)break}}}}B&&w!==t[f]||(n[f]&g.KSIDE_CASTLE&&(w=t[f],B=w+2,null!=e[w+1]||null!=e[B]||G(m,t[f])||G(m,w+1)||G(m,B)||b(e,c,t[f],B,g.KSIDE_CASTLE)),n[f]&g.QSIDE_CASTLE&&(w=t[f],
B=w-2,null!=e[w-1]||null!=e[w-2]||null!=e[w-3]||G(m,t[f])||G(m,w-1)||G(m,B)||b(e,c,t[f],B,g.QSIDE_CASTLE)));if(!p)return c;m=[];a=0;for(d=c.length;a<d;a++)H(c[a]),I(f)||m.push(c[a]),L();return m}function ba(){function a(){if(!I(q))return p(b),!0;p(b);return!1}for(var b=y(),c=l.a8;c<=l.h1;c++)if(c&136)c+=7;else{var f=e[c];null!=f&&f.color===q&&("n"===f.type?specialMoves(h(c),e[c]).forEach(function(b){Q(b);if(a())return!0}):"r"===f.type?specialMoves(h(c),e[c]).forEach(function(b){N({type:"w",color:q},
b);if(a())return!0}):"k"===f.type&&specialMoves(h(c),e[c]).forEach(function(b){Q(b);N({type:"w",color:J(q)},b);if(a())return!0}))}return!1}function K(a,b){var c="";if(a.flags&g.KSIDE_CASTLE)c="O-O";else if(a.flags&g.QSIDE_CASTLE)c="O-O-O";else{b=F({legal:!b});for(var f=a.from,m=a.to,d=a.piece,e=0,l=0,h=0,k=0,n=b.length;k<n;k++){var r=b[k].from,t=b[k].to;d===b[k].piece&&f!==r&&m===t&&(e++,f>>4===r>>4&&l++,(f&15)===(r&15)&&h++)}b=0<e?0<l&&0<h?x(f):0<h?x(f).charAt(1):x(f).charAt(0):"";"p"!==a.piece&&
(c+=a.piece.toUpperCase()+b);a.flags&(g.CAPTURE|g.EP_CAPTURE)&&("p"===a.piece&&(c+=x(a.from)[0]),c+="x");c+=x(a.to);a.flags&g.PROMOTION&&(c+="="+a.promotion.toUpperCase())}a=y();I(q)&&(c=S()?c+"#":c+"+");p(a);return c}function T(a){return a.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function G(a,b){for(var c=l.a8;c<=l.h1;c++)if(c&136)c+=7;else if(null!=e[c]&&e[c].color===a&&"w"!=e[c].type){var f=e[c],m=c-b,d=m+119;if(ia[d]&1<<ja[f.type])if("p"===f.type)if(0<m){if("w"===f.color)return!0}else{if("b"===
f.color)return!0}else{if("n"===f.type||"k"===f.type)return!0;f=ka[d];m=c+f;for(d=!1;m!==b;){if(null!=e[m]){d=!0;break}m+=f}if(!d)return!0}}return!1}function I(a){return G(J(a),t[a])}function S(){return I(q)&&0===F().length&&!ba()}function U(){return!I(q)&&0===F().length&&!ba()}function V(){for(var a={},b=[],c=0,f=0,d=l.a8;d<=l.h1;d++)if(f=(f+1)%2,d&136)d+=7;else{var g=e[d];g&&(a[g.type]=g.type in a?a[g.type]+1:1,"b"===g.type&&b.push(f),c++)}if(2===c||3===c&&(1===a.b||1===a.n))return!0;if(c===a.b+
2){a=0;c=b.length;for(d=0;d<c;d++)a+=b[d];if(0===a||a===c)return!0}return!1}function W(){var a={};ca.forEach(function(b){b=b.split(" ").slice(0,4).join(" ");a[b]=b in a?a[b]+1:1;if(3<=a[b])return!0});return!1}function H(a){var b=q,c=J(b);D.push({move:a,kings:{b:t.b,w:t.w},turn:q,castling:{b:n.b,w:n.w},ep_square:A,half_moves:z,move_number:C});e[a.to]=e[a.from];e[a.from]=null;a.flags&g.EP_CAPTURE&&("b"===q?e[a.to-16]=null:e[a.to+16]=null);a.flags&g.PROMOTION&&(e[a.to]={type:a.promotion,color:b});if("k"===
e[a.to].type){t[e[a.to].color]=a.to;if(a.flags&g.KSIDE_CASTLE){var f=a.to-1,d=a.to+1;e[f]=e[d];e[d]=null}else a.flags&g.QSIDE_CASTLE&&(f=a.to+1,d=a.to-2,e[f]=e[d],e[d]=null);n[b]=""}if(n[b])for(f=0,d=E[b].length;f<d;f++)if(a.from===E[b][f].square&&n[b]&E[b][f].flag){n[b]^=E[b][f].flag;break}if(n[c])for(f=0,d=E[c].length;f<d;f++)if(a.to===E[c][f].square&&n[c]&E[c][f].flag){n[c]^=E[c][f].flag;break}A=a.flags&g.BIG_PAWN?"b"===q?a.to-16:a.to+16:-1;"p"===a.piece?z=0:a.flags&(g.CAPTURE|g.EP_CAPTURE)?z=
0:z++;"b"===q&&C++;q=J(q)}function L(){var a=D.pop();if(null==a)return null;var b=a.move;t=a.kings;q=a.turn;n=a.castling;A=a.ep_square;z=a.half_moves;C=a.move_number;a=q;var c=J(q);e[b.from]=e[b.to];e[b.from].type=b.piece;e[b.to]=null;b.flags&g.CAPTURE?e[b.to]={type:b.captured,color:c}:b.flags&g.EP_CAPTURE&&(e["b"===a?b.to-16:b.to+16]={type:"p",color:c});if(b.flags&(g.KSIDE_CASTLE|g.QSIDE_CASTLE)){if(b.flags&g.KSIDE_CASTLE){var f=b.to+1;var d=b.to-1}else b.flags&g.QSIDE_CASTLE&&(f=b.to-2,d=b.to+1);
e[f]=e[d];e[d]=null}return b}function X(a,b){a=T(a);if(b){var c=a.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(c)var f=c[1],d=c[2],e=c[3],g=c[4]}for(var k=F(),h=0,n=k.length;h<n;h++)if(a===T(K(k[h]))||b&&a===T(K(k[h],!0))||!(!c||f&&f.toLowerCase()!=k[h].piece||l[d]!=k[h].from||l[e]!=k[h].to||g&&g.toLowerCase()!=k[h].promotion))return k[h];return null}function x(a){var b=a&15;a>>=4;return"abcdefgh".substring(b,b+1)+"87654321".substring(a,a+1)}function J(a){return"w"===a?"b":
"w"}function O(a){a=da(a);a.san=K(a,!1);a.to=x(a.to);a.from=x(a.from);var b="",c;for(c in g)g[c]&a.flags&&(b+=ea[c]);a.flags=b;return a}function da(a){var b=a instanceof Array?[]:{},c;for(c in a)b[c]="object"===typeof c?da(a[c]):a[c];return b}function fa(a){for(var b=F({legal:!1}),c=0,f=q,d=0,e=b.length;d<e;d++){H(b[d]);if(!I(f))if(0<a-1){var g=fa(a-1);c+=g}else c++;L()}return c}var la=["1-0","0-1","1/2-1/2","*"],R={b:[16,32,17,15],w:[-16,-32,-17,-15]},aa={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,
17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1],w:[]},ia=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,
0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],ka=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,
0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],ja={p:0,n:1,b:2,r:3,q:4,k:5},ea={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},g={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},l={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,
c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},E={w:[{square:l.a1,flag:g.QSIDE_CASTLE},{square:l.h1,flag:g.KSIDE_CASTLE}],b:[{square:l.a8,flag:g.QSIDE_CASTLE},{square:l.h8,flag:g.KSIDE_CASTLE}]},e=Array(128),t={w:-1,b:-1},q="w",n={w:0,b:0},A=-1,z=0,C=1,D=[],ca=
[],v={};"undefined"===typeof d?p("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"):p(d);return{WHITE:"w",BLACK:"b",PAWN:"p",KNIGHT:"n",BISHOP:"b",ROOK:"r",QUEEN:"q",KING:"k",WALL:"w",SQUARES:function(){for(var a=[],b=l.a8;b<=l.h1;b++)b&136?b+=7:a.push(x(b));return a}(),FLAGS:ea,load:function(a){return p(a)},reset:function(){p("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1")},moves:function(a){for(var b=F(a),c=[],f=0,d=b.length;f<d;f++)"undefined"!==typeof a&&"verbose"in a&&a.verbose?
c.push(O(b[f])):c.push(K(b[f],!1));return c},in_check:function(){return I(q)},in_checkmate:function(){return S()},in_stalemate:function(){return U()},in_draw:function(){return 100<=z||U()||V()||W()},insufficient_material:function(){return V()},in_threefold_repetition:function(){return W()},game_over:function(){return 100<=z||S()||U()||V()||W()},validate_fen:function(a){return r(a)},fen:function(){return y()},board:function(){for(var a=[],b=[],c=l.a8;c<=l.h1;c++)null==e[c]?b.push(null):b.push({type:e[c].type,
color:e[c].color}),c+1&136&&(a.push(b),b=[],c+=8);return a},pgn:function(a){var b="object"===typeof a&&"string"===typeof a.newline_char?a.newline_char:"\n";a="object"===typeof a&&"number"===typeof a.max_width?a.max_width:0;var c=[],d=!1,e;for(e in v)c.push("["+e+' "'+v[e]+'"]'+b),d=!0;d&&D.length&&c.push(b);for(e=[];0<D.length;)e.push(L());d=[];for(var g="";0<e.length;){var h=e.pop();D.length||"b"!==h.color?"w"===h.color&&(g.length&&d.push(g),g=C+"."):g=C+". ...";g=g+" "+K(h,!1);H(h)}g.length&&d.push(g);
"undefined"!==typeof v.Result&&d.push(v.Result);if(0===a)return c.join("")+d.join(" ");for(e=g=0;e<d.length;e++)g+d[e].length>a&&0!==e?(" "===c[c.length-1]&&c.pop(),c.push(b),g=0):0!==e&&(c.push(" "),g++),c.push(d[e]),g+=d[e].length;return c.join("")},load_pgn:function(a,b){function c(a){return a.replace(/\\/g,"\\")}function d(a){for(var b in a)return!0;return!1}var e="undefined"!==typeof b&&"sloppy"in b?b.sloppy:!1,g="object"===typeof b&&"string"===typeof b.newline_char?b.newline_char:"\r?\n",h=
new RegExp("^(\\[(.|"+c(g)+")*\\])("+c(g)+")*1.("+c(g)+"|.)*$","g");h=a.replace(h,"$1");"["!==h[0]&&(h="");p("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1");b=function(a,b){var d={};a=a.split(new RegExp(c("object"===typeof b&&"string"===typeof b.newline_char?b.newline_char:"\r?\n")));for(var f,e=0;e<a.length;e++)b=a[e].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),f=a[e].replace(/^\[[A-Za-z]+\s"(.*)"\]$/,"$1"),0<b.replace(/^\s+|\s+$/g,"").length&&(d[b]=f);return d}(h,b);for(var k in b)P([k,
b[k]]);if("1"===b.SetUp&&!("FEN"in b&&p(b.FEN)))return!1;a=a.replace(h,"").replace(new RegExp(c(g),"g")," ");a=a.replace(/(\{[^}]+\})+?/g,"");for(g=/(\([^\(\)]+\))+?/g;g.test(a);)a=a.replace(g,"");a=a.replace(/\d+\.(\.\.)?/g,"");a=a.replace(/\.\.\./g,"");a=a.replace(/\$\d+/g,"");a=a.replace(/^\s+|\s+$/g,"").split(new RegExp(/\s+/));a=a.join(",").replace(/,,+/g,",").split(",");g="";for(k=0;k<a.length-1;k++){g=X(a[k],e);if(null==g)return!1;H(g)}g=a[a.length-1];if(-1<la.indexOf(g))d(v)&&"undefined"===
typeof v.Result&&P(["Result",g]);else{g=X(g,e);if(null==g)return!1;H(g)}return!0},header:function(){return P(arguments)},ascii:function(){for(var a="   +------------------------+\n",b=l.a8;b<=l.h1;b++){0===(b&15)&&(a+=" "+"87654321"[b>>4]+" |");if(null==e[b])a+=" . ";else{var c=e[b].type;c="w"===e[b].color?c.toUpperCase():c.toLowerCase();a+=" "+c+" "}b+1&136&&(a+="|\n",b+=8)}return a+"   +------------------------+\n     a  b  c  d  e  f  g  h\n"},turn:function(){return q},move:function(a,b){var c=
"undefined"!==typeof b&&"sloppy"in b?b.sloppy:!1;b=null;if("string"===typeof a)b=X(a,c);else if("object"===typeof a){c=F();for(var d=0,e=c.length;d<e;d++)if(!(a.from!==x(c[d].from)||a.to!==x(c[d].to)||"promotion"in c[d]&&a.promotion!==c[d].promotion)){b=c[d];break}}if(!b)return null;a=O(b);H(b);return a},undo:function(){var a=L();return a?O(a):null},clear:function(){return k()},put:function(a,b){return N(a,b)},get:function(a){return Y(a)},remove:function(a){return Q(a)},perft:function(a){return fa(a)},
square_color:function(a){return a in l?(a=l[a],0===((a>>4)+(a&15))%2?"light":"dark"):null},history:function(a){var b=[],c=[];a="undefined"!==typeof a&&"verbose"in a&&a.verbose;for(;0<D.length;)b.push(L());for(;0<b.length;){var d=b.pop();a?c.push(O(d)):c.push(K(d));H(d)}return c},log_move:function(){ca.push(y())}}};"undefined"!==typeof exports&&(exports.Chess=Chess);"undefined"!==typeof define&&define(function(){return Chess});
